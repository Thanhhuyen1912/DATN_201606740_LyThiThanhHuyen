<div style="margin: 10px auto; font-size: 24px; text-align: center;">
    <p>Danh sách sản phẩm mua</p>
</div>
<table id="donmuaTable" class="table table-bordered table-sm">
    <thead>
        <tr>
            <th class="tt" style="width: 180px; cursor: pointer;" onclick="sortTable(0)">Tên sản phẩm</th>
            <th class="tt" style="width: 130px; cursor: pointer;" onclick="sortTable(1)">Giá tiền</th>
            <th class="tt" style="width: 120px; cursor: pointer;" onclick="sortTable(2)">Giảm giá</th>
            <th class="tt" style="width: 50px; cursor: pointer;" onclick="sortTable(3)">Số lượng</th>
            <th class="tt" style="width: 140px; cursor: pointer;" onclick="sortTable(4)">Tổng tiền</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr style="font-size:15px">
                <td>@item.TenSanPham</td>
                <td>@item.GiaTien.ToString("N0")đ</td>
                <td>@item.GiaGiam.ToString("N0")đ</td>
                <td>@item.SoLuong</td>
                <td>@item.TongTien.ToString("N0")đ</td>               
            </tr>
        }
    </tbody>
</table>


<style>
    .tt {
        color: #a75851;
    }

    /* Căn giữa nội dung các ô */
    #donmuaTable th, #donmuaTable td {
        text-align: center;
        vertical-align: middle;
        padding: 7px;
    }

    /* Màu chữ tiêu đề bảng */
    #donmuaTable thead th {
        color: #a75851; /* Màu xanh dương Bootstrap */
        font-weight: bold;
    }

    .btncapnhat {
        background-color: #fdb9a4;
        color: #a75851;
        padding: 7px;
        border-radius: 4px;
        display: block;
        text-align: center;
    }

        .btncapnhat:hover {
            background-color: #fdb9a4;
            color: #a75851;
        }

    /* Tuỳ chọn thêm: bo tròn góc nút và padding */

</style>
<!-- Nút phân trang -->
<div id="pagination" class="mt-3 text-center" style="justify-content:right"></div>


<div style="display: flex; justify-content: center; margin-top: 20px;">
    <a href="/DonHang/DonMua" class="btncapnhat">Quay lại</a>
</div>

<script>



    document.addEventListener("DOMContentLoaded", function () {
        const table = document.getElementById("donmuaTable");
        const tbody = table.querySelector("tbody");
        const rows = tbody.querySelectorAll("tr");
        const rowsPerPage = 10;
        const totalPages = Math.ceil(rows.length / rowsPerPage);
        const pagination = document.getElementById("pagination");

        function showPage(page) {
            // Ẩn tất cả các hàng
            rows.forEach((row, index) => {
                row.style.display = "none";
            });

            // Hiển thị hàng thuộc trang hiện tại
            const start = (page - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            for (let i = start; i < end && i < rows.length; i++) {
                rows[i].style.display = "";
            }

            // Tô đậm nút đang được chọn
            const buttons = pagination.querySelectorAll("button");
            buttons.forEach(btn => btn.classList.remove("active"));
            if (buttons[page - 1]) buttons[page - 1].classList.add("active");
        }

        function createPagination() {
            for (let i = 1; i <= totalPages; i++) {
                const btn = document.createElement("button");
                btn.textContent = i;
                btn.className = "btn btn-sm  mx-1";
                   btn.style.color = "#a75851";
                   btn.style.backgroundColor = "#fdb9a4";

                btn.addEventListener("click", function () {
                    showPage(i);
                });
                pagination.appendChild(btn);
            }
        }

        if (rows.length > 0) {
            createPagination();
            showPage(1);
        }
    });

    let sortDirection = {}; // theo dõi chiều sắp xếp từng cột

    function sortTable(columnIndex) {
        const table = document.getElementById("donmuaTable");
        const tbody = table.tBodies[0];
        const rows = Array.from(tbody.rows);

        // Xác định kiểu dữ liệu (số hay chữ)
        const isNumeric = columnIndex === 2; // Cột "Tổng tiền"

        // Đảo chiều nếu đã sắp xếp rồi
        sortDirection[columnIndex] = !sortDirection[columnIndex];

        rows.sort((a, b) => {
            let valA = a.cells[columnIndex].innerText.trim();
            let valB = b.cells[columnIndex].innerText.trim();

            if (isNumeric) {
                valA = parseInt(valA.replace(/\D/g, '')) || 0;
                valB = parseInt(valB.replace(/\D/g, '')) || 0;
            } else {
                valA = valA.toLowerCase();
                valB = valB.toLowerCase();
            }

            if (valA < valB) return sortDirection[columnIndex] ? -1 : 1;
            if (valA > valB) return sortDirection[columnIndex] ? 1 : -1;
            return 0;
        });

        // Cập nhật lại thứ tự hàng trong tbody
        rows.forEach(row => tbody.appendChild(row));
    }
</script>